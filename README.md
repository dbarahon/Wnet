

# Vertical Velocity Standard Deviation Calculation and Plotting

## Overview

This repository contains four different Python scripts for calculating and plotting the standard deviation in vertical wind velocity (sigmaW), and to demonstrate the Constraining Adversarial Trainining method following Barahona et al. "Deep Learning Parameterization of Vertical Wind Velocity Variability via Constrained Adversarial Training (doi:tbd)". 

These scripts are designed to work with gridded, netcdf data from observations, high resolution simulated output, and reanalysis data. Observartional and reanalysis data should represent time series of sigmaW and atmospheric state  at different vertical positions, respectively, while the simulated data is taken from the NAS GEOS-5 Nature Run (G5NR), https://gmao.gsfc.nasa.gov/global_mesoscale/7km-G5NR/data_access/. Other scripts provide various methods for computing and visualizing sigmaW.

## Files

### 1. `Wnet_prior.py`

This scrip uses data from G5NR, to train and neural network, "Wnet-prior" that reads predicts sigmaW from the meteorological state. Because the G5NR data set is too extensive to fit in memory, only a few half-hourly output files (3-5 files) are loaded at once for training a few epochs. Then a entire new set is loaded and so on. Using dask, the training datasets are lazily loaded. A "dask-generator" is build to feed data for training, aligning each minibatch with the chunks of the dask array.     

### 2. `filtered_velocity.py`

This script uses a low-pass filter to smooth the vertical position data before calculating velocity. Smoothing helps reduce noise and provides a more stable estimate of velocity. To use this script:

```bash
python filtered_velocity.py input_file.csv output_file.csv
```

- `input_file.csv`: A CSV file containing time and vertical position data.
- `output_file.csv`: A CSV file where the calculated filtered vertical velocity will be saved.

### 3. `acceleration_velocity.py`

This script calculates vertical velocity by integrating vertical acceleration data. It first computes acceleration by taking the derivative of vertical velocity and then integrates it to obtain velocity. This approach can be useful when you have accurate acceleration measurements. To use this script:

```bash
python acceleration_velocity.py input_file.csv output_file.csv
```

- `input_file.csv`: A CSV file containing time and vertical acceleration data.
- `output_file.csv`: A CSV file where the calculated vertical velocity will be saved.

### 4. `plot_velocity.py`

This script is used to visualize the calculated vertical velocity from any of the previous three methods. It generates a time-velocity plot and saves it as an image file. To use this script:

```bash
python plot_velocity.py input_file.csv output_image.png
```

- `input_file.csv`: A CSV file containing time and vertical velocity data (generated by one of the previous scripts).
- `output_image.png`: An image file where the velocity plot will be saved.

## Dependencies

Each script has specific dependencies, which can be installed using `pip` or another package manager. Please refer to the individual script's documentation for details on their dependencies.

## Example Data

You can find example data in the `data` directory for testing these scripts. Feel free to use this data to get started.

## License

This project is licensed under the MIT License. Please see the `LICENSE` file for more details.

## Acknowledgments

If you find these scripts useful, please consider giving credit by citing this repository or mentioning it in your project's acknowledgments.

---

**Note**: Make sure to replace `input_file.csv`, `output_file.csv`, `output_image.png`, and any other placeholders with your actual file names and paths when using these scripts.

# Wnet

GEOS software: https://github.com/GEOS-ESM/GEOSgcm

Data availability:
<ul>
<li>GEOS-5 Nature Run: https://gmao.gsfc.nasa.gov/global_mesoscale/7km-G5NR/data_access/
<li>MERRA-2: doi: 10.5067/VJAFPLI1CSIV
<li>Observations: https://www.arm.gov/data/
